var host={},host_location="http://localhost:3000/";function host_create(){return host_location+"create.html"}function host_browse(){return host_location+"browse.html"}function host_play(){return host_location+"play/"};var users={};function users_generateNewUser(){return{username:"none",password:"none"}}function users_getUsername(){return window.localStorage.getItem("token")?JSON.parse(window.localStorage.getItem("token")).user:"INVALID"}function users_setToken(a){$.when(window.localStorage.setItem("token",JSON.stringify(a))).done()}function users_flushToken(){window.localStorage.setItem("token","")}
function users_getToken(){return window.localStorage.getItem("token")?JSON.parse(window.localStorage.getItem("token")):"INVALID"};var browser_httpRequests={};function browser_httpRequests_getProjectsForBrowser(a,b){return $.ajax({url:"/getAllUsersProjects",data:{published:b},cache:!1,type:"GET",success:function(b){a.data=b},contenttype:"application/json"})}function browser_httpRequests_addTokenToHeader(){var a=window.localStorage.getItem("token");a&&(a=JSON.parse(a).token,$.ajaxSetup({headers:{"x-access-token":a}}))}
function browser_httpRequests_handleAuth(a){console.log("server returned"+a);return"EXPIRED"===a||"NO_TOKEN"===a?("EXPIRED"===a?console.log("http_handleAuth(): Token is expired"):console.log("http_handleAuth(): No Token"),users_flushToken(),browser_httpRequests_redirectHome(),!1):!0}function browser_httpRequests_redirectHome(){window.location=host_create()};var gameBrowser={},gameBrowser_allProjects;gameBrowser_loadUsers();
function gameBrowser_loadUsers(){var a={data:{}};+$.when(browser_httpRequests_getProjectsForBrowser(a,!0)).done(function(){gameBrowser_allProjects=a.data;console.log(gameBrowser_allProjects);gameBrowser_displayAllGames(gameBrowser_allProjects);for(var b=0;b<gameBrowser_allProjects.users.length;b++)for(var c=0;c<gameBrowser_allProjects.users[b].projects.length;c++)gameBrowser_displayGame(gameBrowser_allProjects.users[b].projects[c]),console.log(gameBrowser_allProjects.users[b].projects[c]);$(".loading-content").hide();
$("#main-content").show()})}
function gameBrowser_displayAllGames(a){$("#recommended-games-list").empty();a=$("#all-games-list");a.empty();if(gameBrowser_allProjects!={})for(var b=0;b<gameBrowser_allProjects.users.length;b++)for(var c=0;c<gameBrowser_allProjects.users[b].projects.length;++c)gameBrowser_displayGame(gameBrowser_allProjects.users[b].projects[c],generateID());else $("#main-content").innerHTML="<h1>There are no games to show</h1>";""==a.html&&a.append("<h4 style='color: #fff; margin-left: 10px;'>Be the first to publish a game!</h4> <a class='btn btn-medium waves-effect waves-light grey' href='create.html'>Create a Game</a>");a.css("min-height",
a.height()+"px")}
function gameBrowser_filterByUsername(a,b){var c=$("#all-games-list");c.empty();var f=!1;if(gameBrowser_allProjects!={})for(var d=0;d<gameBrowser_allProjects.users.length;d++)if(gameBrowser_allProjects.users[d].name.includes(b))for(var f=!0,e=0;e<gameBrowser_allProjects.users[d].projects.length;e++)gameBrowser_displayGame(gameBrowser_allProjects.users[d].projects[e]);f||c.append("<h4 style='color: #fff; margin-left: 10px;'>No games found with a username matching <span style='color: #00FEBC'>"+b+"</span></h4>")}
function gameBrowser_displayGame(a,b){var c='<div class="col s12 m6 l3"><div class="card medium z-depth-3 darken-2"> <div class="card-image" id="project-'+b+'-image"><span class="card-title"><p>'+a.title+'</p><p style="font-size: 18px;">Created By: '+a.author+'</p></span></div><div class="card-content white-text"> <p>'+a.description+'</p> </div> <div class="card-action"><a href="'+a.gameLink+'"><span class="accent-color">Play Game</span></a> </div> </div> </div>';"Admin"==a.author?$("#recommended-games-list").append(c):
$("#all-games-list").append(c);c=$("#project-"+b+"-image");c.css("background-image","url("+a.imageLink+")");c.css("background-size","cover")}var timerid;$("#search-bar").on("input",function(a){a=$(this).val();$(this).data("lastval")!=a&&($(this).data("lastval",a),clearTimeout(timerid),timerid=setTimeout(function(){var a=$("#search-bar").val();$("#all-games-list").empty();""!=a?gameBrowser_filterByUsername(gameBrowser_allProjects,a):gameBrowser_displayAllGames(gameBrowser_allProjects)},250))});
function generateID(){for(var a="",b=0;3>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a};
